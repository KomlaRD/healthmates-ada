---
title: "Ada malnutrition report"
author: "Healthmates Nutrition"
date: "8/28/2021"
institute: "Healthmates Nutrition Limited"
output:
  html_document:
    toc: true
    toc_float: true
  css: "bootstrap.css"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


![](/Users/ericanku/Documents/Healthmates/ada_project_analysis/healthmates-ada/healthmates.JPG)


```{r import, echo=FALSE}
# Importing packages for project

pacman::p_load (
        tidyverse, # Data management
        rio, # Importing dataset
        here, # Working directory
        janitor, # Clean data names
        googlesheets4, # Read sheets from Google sheets
        gtsummary, # Create summary tables
        skimr, # Overview of dataset
        GGally, # Correlation matrix
        tinytex, # Creating pdf documents
        finalfit, # Creating models
        ggthemes, # Plot themes
        ggstatsplot, # Inferential plots
        knitr # Chunk options
        
        
)
```


```{r import-dataset, include=FALSE}

                  


```





```{r include=FALSE}
ff_glimpse(ada)

missing_glimpse(ada)
```




```{r ada-five-wrangling,warning=FALSE}
ada_five<- ada_five%>%
        mutate (
                sex = factor(sex)%>%
                        fct_recode("Male" = "1",
                                   "Female" = "2")%>%
                        ff_label("Sex"),
                
                marital_status = factor(marital_status)%>%
                        fct_recode("Married" = "1",
                                   "Single" = "2",
                                   "Separated/Divorced" = "3",
                                   "Cohabiting" = "4")%>%
                        ff_label("Marital status"),
                
                educ_mum = factor(educ_mum)%>%
                        fct_recode("Never attended school" = "1",
                                   "Elementary/Primary" = "2",
                                   "Junior High" = "3",
                                   "Senior High" = "4",
                                   "Tertiary" = "5")%>%
                        ff_label("Educational status"),
                
                occupation_mum = factor(occupation_mum)%>%
                        fct_recode("Farmer" = "1",
                                   "Trader" = "2",
                                   "Dressmaker" = "3",
                                   "Hairdresser" = "4",
                                   "Others" = "5")%>%
                        ff_label("Occupation"),
                
                income = factor(income)%>%
                        fct_recode("Less than 500 cedis"="1",
                                   "500-900 cedis" = "2",
                                   "1000-1500 cedis" = "3",
                                   "1500 cedis" = "4")%>%
                        ff_label("Income"),
                
                breastfeed_child = factor(breasfeed_child)%>%
                        fct_recode("No"="0",
                                   "Yes" = "1",
                                   "Don't know" = "9")%>%
                        ff_label("Breastfeed"),
                
                duration_bf = factor(duration_bf)%>%
                        fct_recode("Immediately" = "1",
                                   "Within first hour" = "2",
                                   "Hours" = "3",
                                   "Don't know" = "9")%>%
                        ff_label("Duration of breastfeeding"),
                
                day_bf = factor (day_bf)%>%
                        fct_recode("No" = "0",
                                   "Yes" = "1",
                                   "Don't know" = "9")%>%
                        ff_label("Breastfed the day before survey"),
                
                age_intro_feed = factor (age_intro_feed)%>%
                        fct_recode("<= 2 months" = "1",
                                   "3 months" = "2",
                                   "4 months" = "3",
                                   "5 months" = "4",
                                   "6 months" = "5",
                                   "> 6 months" = "6",
                                   "Don't know" = "9")%>%
                        ff_label("Age of introducing complementary meals"),
                
                edema = factor(edema)%>%
                        fct_recode("No" = "0",
                                   "Yes"= "1")%>%
                        ff_label("Edema"),
                
                age_mons = age_mons%>%
                        ff_label("Age of child (months)"),
                
                age_mother = age_mother%>%
                        ff_label("Age of mother (years)"),
                
                `num-child` = `num-child`%>%
                        ff_label("Number of children"),
                
                hours_bf = hours_bf%>%
                        ff_label("Hours after breastfeeding"),
                
                average_intake = average_intake%>%
                        ff_label("Average intake of meals"),
                
                bwt = bwt%>%
                        ff_label("Birth weight (kg)"),
                
                wt = wt%>%
                        ff_label("Weight of child (kg)"),
                
                lenhei = lenhei%>%
                        ff_label("Length/Height (cm)"),
                
                head_circumference = head_circumference%>%
                        ff_label("Head circumference (cm)"),
                
                muac = muac%>%
                        ff_label("Mid-upper arm circumference")
                
                
                
                
                        
                
                                   )



ada_five_analysis <- ada_five%>%
        select(-c(`start-time`,`end-time`, today, name, dob, display_age, age_manual, breasfeed_child))
```




```{r ada-nine-wrangling,warning=FALSE}
ada_nine<- ada_nine%>%
        mutate (
                sex = factor(sex)%>%
                        fct_recode("Male" = "1",
                                   "Female" = "2")%>%
                        ff_label("Sex"),
                
                marital_status = factor(marital_status)%>%
                        fct_recode("Married" = "1",
                                   "Single" = "2",
                                   "Separated/Divorced" = "3",
                                   "Cohabiting" = "4")%>%
                        ff_label("Marital status"),
                
                educ_mum = factor(educ_mum)%>%
                        fct_recode("Never attended school" = "1",
                                   "Elementary/Primary" = "2",
                                   "Junior High" = "3",
                                   "Senior High" = "4",
                                   "Tertiary" = "5")%>%
                        ff_label("Educational status"),
                
                occupation_mum = factor(occupation_mum)%>%
                        fct_recode("Farmer" = "1",
                                   "Trader" = "2",
                                   "Dressmaker" = "3",
                                   "Hairdresser" = "4",
                                   "Others" = "5")%>%
                        ff_label("Occupation"),
                
                income = factor(income)%>%
                        fct_recode("Less than 500 cedis"="1",
                                   "500-900 cedis" = "2",
                                   "1000-1500 cedis" = "3",
                                   "1500 cedis" = "4")%>%
                        ff_label("Income"),
                
                breastfeed_child = factor(breasfeed_child)%>%
                        fct_recode("No"="0",
                                   "Yes" = "1",
                                   "Don't know" = "9")%>%
                        ff_label("Breastfeed"),
                
                duration_bf = factor(duration_bf)%>%
                        fct_recode("Immediately" = "1",
                                   "Within first hour" = "2",
                                   "Hours" = "3",
                                   "Don't know" = "9")%>%
                        ff_label("Duration of breastfeeding"),
                
                day_bf = factor (day_bf)%>%
                        fct_recode("No" = "0",
                                   "Yes" = "1",
                                   "Don't know" = "9")%>%
                        ff_label("Breastfed the day before survey"),
                
                age_intro_feed = factor (age_intro_feed)%>%
                        fct_recode("<= 2 months" = "1",
                                   "3 months" = "2",
                                   "4 months" = "3",
                                   "5 months" = "4",
                                   "6 months" = "5",
                                   "> 6 months" = "6",
                                   "Don't know" = "9")%>%
                        ff_label("Age of introducing complementary meals"),
                
                edema = factor(edema)%>%
                        fct_recode("No" = "0",
                                   "Yes"= "1")%>%
                        ff_label("Edema"),
                
                age_mons = age_mons%>%
                        ff_label("Age of child (months)"),
                
                age_mother = age_mother%>%
                        ff_label("Age of mother (years)"),
                
                `num-child` = `num-child`%>%
                        ff_label("Number of children"),
                
                hours_bf = hours_bf%>%
                        ff_label("Hours after breastfeeding"),
                
                average_intake = average_intake%>%
                        ff_label("Average intake of meals"),
                
                bwt = bwt%>%
                        ff_label("Birth weight (kg)"),
                
                wt = wt%>%
                        ff_label("Weight of child (kg)"),
                
                lenhei = lenhei%>%
                        ff_label("Length/Height (cm)"),
                
                head_circumference = head_circumference%>%
                        ff_label("Head circumference (cm)"),
                
                muac = muac%>%
                        ff_label("Mid-upper arm circumference")
                        
                
                                   )

ada_nine_analysis <- ada_nine%>%
        select(-c(`start-time`,`end-time`, today, name, dob, display_age, age_manual, breasfeed_child))
```



***
## Introduction


## Summary

***


## Nutrition assessment


## Exploratory data analysis

![malnutrition](/Users/ericanku/Documents/Healthmates/ada_project_analysis/healthmates-ada/ada_five_anthro_zscores_distributions.png)

### Table summary for children 5 years and below




```{r}
tbl_summary(ada_five_analysis)
```



### Table summary for children above 5 years



```{r}
tbl_summary(ada_nine_analysis)
```




### Skim data of children 5 years and below




```{r}
skim(ada_five_analysis)
```



### Skim data of children above 5 years


```{r}
skim(ada_nine_analysis)
```




### Correlation matrix of children 5 years and below



```{r message=FALSE,warning=FALSE,cache=TRUE,warning=FALSE}
ada_five_analysis%>%
        select(age_mons, age_mother, `num-child`, average_intake, bwt, wt, lenhei, head_circumference, muac)%>%
        ggpairs(title = "Correlation matrix for children 5 years and below")
```




### Correlation matrix of children older than 5 years



```{r message=FALSE,message=FALSE,cache=TRUE,warning=FALSE}
ada_nine_analysis%>%
        select(age_mons, age_mother, `num-child`, average_intake, wt, lenhei)%>%
        ggpairs(title = "Correlation matrix for children above 5 years")
```


***


## Visualisations



### Children 5 years and below



#### Sex of children



```{r}
ggplot(data = ada_five_analysis, aes(sex, fill = sex))+
        
        geom_bar()+
        
        labs(title="Sex of children",x="Sex", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")
```




#### Educational level of mothers



```{r educational-plot}
ggplot(data = ada_five_analysis, aes(educ_mum, fill = educ_mum))+
        
        geom_bar()+
        
        labs(title="Educational level of mothers",x="Educational level", y = "Frequency",fill="Educational level")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Marital status of mothers



```{r}
ggplot(data = ada_five_analysis, aes(marital_status, fill = marital_status))+
        
        geom_bar()+
        
        labs(title="Marital status of mothers",x="Marital status", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Occupation of mothers



```{r}
ggplot(data = ada_five_analysis, aes(occupation_mum, fill = occupation_mum))+
        
        geom_bar()+
        
        labs(title="Occupation of mothers",x="Occupation", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Income of mothers



```{r}
ggplot(data = ada_five_analysis, aes(income, fill = income))+
        
        geom_bar()+
        
        labs(title="Income of mothers",x="Income", y = "Frequency",fill="Educational level")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```



#### Duration of breastfeeding after birth



```{r}
ggplot(data = ada_five_analysis, aes(duration_bf, fill = duration_bf))+
        
        geom_bar()+
        
        labs(title="Duration of breastfeeding after child was delivered",x="Duration", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```



#### Breastfed the day before the survey



```{r}
ggplot(data = ada_five_analysis, aes(day_bf, fill = day_bf))+
        
        geom_bar()+
        
        labs(title="Was child breastfed the day before the survey",x="Response", y = "Frequency",fill="Educational level")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Age of introduction of complementary foods



```{r}
ggplot(data = ada_five_analysis, aes(age_intro_feed, fill = age_intro_feed))+
        
        geom_bar()+
        
        labs(title="Age of introducing complementary foods",x="Age of introduction", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Edema



```{r}
ggplot(data = ada_five_analysis, aes(edema, fill = edema))+
        
        geom_bar()+
        
        labs(title="Edema",x="Edema", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```



***


### Children above 5 years


#### Sex of children



```{r}
ggplot(data = ada_nine_analysis, aes(sex, fill = sex))+
        
        geom_bar()+
        
        labs(title="Sex of children",x="Sex", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")
```




#### Educational level of mothers



```{r}
ggplot(data = ada_nine_analysis, aes(educ_mum, fill = educ_mum))+
        
        geom_bar()+
        
        labs(title="Educational level of mothers",x="Educational level", y = "Frequency",fill="Educational level")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Marital status of mothers



```{r}
ggplot(data = ada_nine_analysis, aes(marital_status, fill = marital_status))+
        
        geom_bar()+
        
        labs(title="Marital status of mothers",x="Marital status", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Occupation of mothers



```{r}
ggplot(data = ada_nine_analysis, aes(occupation_mum, fill = occupation_mum))+
        
        geom_bar()+
        
        labs(title="Occupation of mothers",x="Occupation", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Income of mothers



```{r}
ggplot(data = ada_nine_analysis, aes(income, fill = income))+
        
        geom_bar()+
        
        labs(title="Income of mothers",x="Income", y = "Frequency",fill="Educational level")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```



#### Duration of breastfeeding after birth



```{r}
ggplot(data = ada_nine_analysis, aes(duration_bf, fill = duration_bf))+
        
        geom_bar()+
        
        labs(title="Duration of breastfeeding after child was delivered",x="Duration", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```



#### Breastfed the day before the survey



```{r}
ggplot(data = ada_nine_analysis, aes(day_bf, fill = day_bf))+
        
        geom_bar()+
        
        labs(title="Was child breastfed the day before the survey",x="Response", y = "Frequency",fill="Educational level")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Age of introduction of complementary foods



```{r}
ggplot(data = ada_nine_analysis, aes(age_intro_feed, fill = age_intro_feed))+
        
        geom_bar()+
        
        labs(title="Age of introducing complementary foods",x="Age of introduction", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


#### Edema



```{r}
ggplot(data = ada_nine_analysis, aes(edema, fill = edema))+
        
        geom_bar()+
        
        labs(title="Edema",x="Edema", y = "Frequency")+
        
        theme_hc()+
        
        guides(fill="none")+
        
  theme(axis.text.x = element_text(angle = 60,hjust = 1))
```


***


## Conclusion


